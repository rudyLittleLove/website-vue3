import{d as K,s as W,o as z,c as O,b as G,w as D,F as L,r as V,a as F,A as H,g as X,p as Y,f as Z}from"./index.289bf692.js";import{E as tt}from"./el-progress.3c3e78ed.js";import{E as rt}from"./el-button.0c3863f2.js";import{_ as et}from"./plugin-vue_export-helper.21dcd24c.js";import"./index.0de585cb.js";import"./index.93f89a9b.js";import"./typescript.6eccdbdd.js";import"./index.a0207f98.js";import"./icon.0d25849f.js";import"./index.96323e08.js";import"./index.ea4d8fa0.js";if(!C)var C={map:function(a,o){var r={};return o?a.map(function(c,i){return r.index=i,o.call(r,c)}):a.slice()},naturalOrder:function(a,o){return a<o?-1:a>o?1:0},sum:function(a,o){var r={};return a.reduce(o?function(c,i,u){return r.index=u,c+o.call(r,i)}:function(c,i){return c+i},0)},max:function(a,o){return Math.max.apply(null,o?C.map(a,o):a)}};var nt=function(){var a=5,o=8-a,r=1e3,c=.75;function i(e,t,s){return(e<<2*a)+(t<<a)+s}function u(e){var t=[],s=!1;function f(){t.sort(e),s=!0}return{push:function(n){t.push(n),s=!1},peek:function(n){return s||f(),n===void 0&&(n=t.length-1),t[n]},pop:function(){return s||f(),t.pop()},size:function(){return t.length},map:function(n){return t.map(n)},debug:function(){return s||f(),t}}}function l(e,t,s,f,n,h,g){var d=this;d.r1=e,d.r2=t,d.g1=s,d.g2=f,d.b1=n,d.b2=h,d.histo=g}l.prototype={volume:function(e){var t=this;return(!t._volume||e)&&(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume},count:function(e){var t=this,s=t.histo;if(!t._count_set||e){var f=0,n,h,g,d;for(n=t.r1;n<=t.r2;n++)for(h=t.g1;h<=t.g2;h++)for(g=t.b1;g<=t.b2;g++)d=i(n,h,g),f+=s[d]||0;t._count=f,t._count_set=!0}return t._count},copy:function(){var e=this;return new l(e.r1,e.r2,e.g1,e.g2,e.b1,e.b2,e.histo)},avg:function(e){var t=this,s=t.histo;if(!t._avg||e){var f=0,n=1<<8-a,h=0,g=0,d=0,_,p,v,w,A;for(p=t.r1;p<=t.r2;p++)for(v=t.g1;v<=t.g2;v++)for(w=t.b1;w<=t.b2;w++)A=i(p,v,w),_=s[A]||0,f+=_,h+=_*(p+.5)*n,g+=_*(v+.5)*n,d+=_*(w+.5)*n;f?t._avg=[~~(h/f),~~(g/f),~~(d/f)]:t._avg=[~~(n*(t.r1+t.r2+1)/2),~~(n*(t.g1+t.g2+1)/2),~~(n*(t.b1+t.b2+1)/2)]}return t._avg},contains:function(e){var t=this,s=e[0]>>o;return gval=e[1]>>o,bval=e[2]>>o,s>=t.r1&&s<=t.r2&&gval>=t.g1&&gval<=t.g2&&bval>=t.b1&&bval<=t.b2}};function y(){this.vboxes=new u(function(e,t){return C.naturalOrder(e.vbox.count()*e.vbox.volume(),t.vbox.count()*t.vbox.volume())})}y.prototype={push:function(e){this.vboxes.push({vbox:e,color:e.avg()})},palette:function(){return this.vboxes.map(function(e){return e.color})},size:function(){return this.vboxes.size()},map:function(e){for(var t=this.vboxes,s=0;s<t.size();s++)if(t.peek(s).vbox.contains(e))return t.peek(s).color;return this.nearest(e)},nearest:function(e){for(var t=this.vboxes,s,f,n,h=0;h<t.size();h++)f=Math.sqrt(Math.pow(e[0]-t.peek(h).color[0],2)+Math.pow(e[1]-t.peek(h).color[1],2)+Math.pow(e[2]-t.peek(h).color[2],2)),(f<s||s===void 0)&&(s=f,n=t.peek(h).color);return n},forcebw:function(){var e=this.vboxes;e.sort(function(n,h){return C.naturalOrder(C.sum(n.color),C.sum(h.color))});var t=e[0].color;t[0]<5&&t[1]<5&&t[2]<5&&(e[0].color=[0,0,0]);var s=e.length-1,f=e[s].color;f[0]>251&&f[1]>251&&f[2]>251&&(e[s].color=[255,255,255])}};function b(e){var t=1<<3*a,s=new Array(t),f,n,h,g;return e.forEach(function(d){n=d[0]>>o,h=d[1]>>o,g=d[2]>>o,f=i(n,h,g),s[f]=(s[f]||0)+1}),s}function m(e,t){var s=1e6,f=0,n=1e6,h=0,g=1e6,d=0,_,p,v;return e.forEach(function(w){_=w[0]>>o,p=w[1]>>o,v=w[2]>>o,_<s?s=_:_>f&&(f=_),p<n?n=p:p>h&&(h=p),v<g?g=v:v>d&&(d=v)}),new l(s,f,n,h,g,d,t)}function j(e,t){if(!t.count())return;var s=t.r2-t.r1+1,f=t.g2-t.g1+1,n=t.b2-t.b1+1,h=C.max([s,f,n]);if(t.count()==1)return[t.copy()];var g=0,d=[],_=[],p,v,w,A,x;if(h==s)for(p=t.r1;p<=t.r2;p++){for(A=0,v=t.g1;v<=t.g2;v++)for(w=t.b1;w<=t.b2;w++)x=i(p,v,w),A+=e[x]||0;g+=A,d[p]=g}else if(h==f)for(p=t.g1;p<=t.g2;p++){for(A=0,v=t.r1;v<=t.r2;v++)for(w=t.b1;w<=t.b2;w++)x=i(v,p,w),A+=e[x]||0;g+=A,d[p]=g}else for(p=t.b1;p<=t.b2;p++){for(A=0,v=t.r1;v<=t.r2;v++)for(w=t.g1;w<=t.g2;w++)x=i(v,w,p),A+=e[x]||0;g+=A,d[p]=g}d.forEach(function(I,B){_[B]=g-I});function k(I){var B=I+"1",P=I+"2",q,N,S,U,M,$=0;for(p=t[B];p<=t[P];p++)if(d[p]>g/2){for(S=t.copy(),U=t.copy(),q=p-t[B],N=t[P]-p,q<=N?M=Math.min(t[P]-1,~~(p+N/2)):M=Math.max(t[B],~~(p-1-q/2));!d[M];)M++;for($=_[M];!$&&d[M-1];)$=_[--M];return S[P]=M,U[B]=S[P]+1,[S,U]}}return h==s?k("r"):h==f?k("g"):k("b")}function E(e,t){if(!e.length||t<2||t>256)return!1;var s=b(e);s.forEach(function(){});var f=m(e,s),n=new u(function(_,p){return C.naturalOrder(_.count(),p.count())});n.push(f);function h(_,p){for(var v=_.size(),w=0,A;w<r;){if(v>=p||w++>r)return;if(A=_.pop(),!A.count()){_.push(A),w++;continue}var x=j(s,A),k=x[0],I=x[1];if(!k)return;_.push(k),I&&(_.push(I),v++)}}h(n,c*t);for(var g=new u(function(_,p){return C.naturalOrder(_.count()*_.volume(),p.count()*p.volume())});n.size();)g.push(n.pop());h(g,t);for(var d=new y;g.size();)d.push(g.pop());return d}return{quantize:E}}(),ot=nt.quantize;function at(a){for(var o=new Array(a),r=0;r<a;++r)o[r]=r;return o}var it=at;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var ut=function(a){return a!=null&&(J(a)||st(a)||!!a._isBuffer)};function J(a){return!!a.constructor&&typeof a.constructor.isBuffer=="function"&&a.constructor.isBuffer(a)}function st(a){return typeof a.readFloatLE=="function"&&typeof a.slice=="function"&&J(a.slice(0,0))}var ct=it,ft=ut,pt=typeof Float64Array!="undefined";function lt(a,o){return a[0]-o[0]}function ht(){var a=this.stride,o=new Array(a.length),r;for(r=0;r<o.length;++r)o[r]=[Math.abs(a[r]),r];o.sort(lt);var c=new Array(o.length);for(r=0;r<c.length;++r)c[r]=o[r][1];return c}function dt(a,o){var r=["View",o,"d",a].join("");o<0&&(r="View_Nil"+a);var c=a==="generic";if(o===-1){var i="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+a+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}",f=new Function(i);return f()}else if(o===0){var i="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+a+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(c?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(c?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}",f=new Function("TrivialArray",i);return f(T[a][0])}var i=["'use strict'"],u=ct(o),l=u.map(function(n){return"i"+n}),y="this.offset+"+u.map(function(n){return"this.stride["+n+"]*i"+n}).join("+"),b=u.map(function(n){return"b"+n}).join(","),m=u.map(function(n){return"c"+n}).join(",");i.push("function "+r+"(a,"+b+","+m+",d){this.data=a","this.shape=["+b+"]","this.stride=["+m+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+a+"'","proto.dimension="+o),i.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+u.map(function(n){return"this.shape["+n+"]"}).join("*"),"}})"),o===1?i.push("proto.order=[0]"):(i.push("Object.defineProperty(proto,'order',{get:"),o<4?(i.push("function "+r+"_order(){"),o===2?i.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):o===3&&i.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):i.push("ORDER})")),i.push("proto.set=function "+r+"_set("+l.join(",")+",v){"),c?i.push("return this.data.set("+y+",v)}"):i.push("return this.data["+y+"]=v}"),i.push("proto.get=function "+r+"_get("+l.join(",")+"){"),c?i.push("return this.data.get("+y+")}"):i.push("return this.data["+y+"]}"),i.push("proto.index=function "+r+"_index(",l.join(),"){return "+y+"}"),i.push("proto.hi=function "+r+"_hi("+l.join(",")+"){return new "+r+"(this.data,"+u.map(function(n){return["(typeof i",n,"!=='number'||i",n,"<0)?this.shape[",n,"]:i",n,"|0"].join("")}).join(",")+","+u.map(function(n){return"this.stride["+n+"]"}).join(",")+",this.offset)}");var j=u.map(function(n){return"a"+n+"=this.shape["+n+"]"}),E=u.map(function(n){return"c"+n+"=this.stride["+n+"]"});i.push("proto.lo=function "+r+"_lo("+l.join(",")+"){var b=this.offset,d=0,"+j.join(",")+","+E.join(","));for(var e=0;e<o;++e)i.push("if(typeof i"+e+"==='number'&&i"+e+">=0){d=i"+e+"|0;b+=c"+e+"*d;a"+e+"-=d}");i.push("return new "+r+"(this.data,"+u.map(function(n){return"a"+n}).join(",")+","+u.map(function(n){return"c"+n}).join(",")+",b)}"),i.push("proto.step=function "+r+"_step("+l.join(",")+"){var "+u.map(function(n){return"a"+n+"=this.shape["+n+"]"}).join(",")+","+u.map(function(n){return"b"+n+"=this.stride["+n+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var e=0;e<o;++e)i.push("if(typeof i"+e+"==='number'){d=i"+e+"|0;if(d<0){c+=b"+e+"*(a"+e+"-1);a"+e+"=ceil(-a"+e+"/d)}else{a"+e+"=ceil(a"+e+"/d)}b"+e+"*=d}");i.push("return new "+r+"(this.data,"+u.map(function(n){return"a"+n}).join(",")+","+u.map(function(n){return"b"+n}).join(",")+",c)}");for(var t=new Array(o),s=new Array(o),e=0;e<o;++e)t[e]="a[i"+e+"]",s[e]="b[i"+e+"]";i.push("proto.transpose=function "+r+"_transpose("+l+"){"+l.map(function(n,h){return n+"=("+n+"===undefined?"+h+":"+n+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+t.join(",")+","+s.join(",")+",this.offset)}"),i.push("proto.pick=function "+r+"_pick("+l+"){var a=[],b=[],c=this.offset");for(var e=0;e<o;++e)i.push("if(typeof i"+e+"==='number'&&i"+e+">=0){c=(c+this.stride["+e+"]*i"+e+")|0}else{a.push(this.shape["+e+"]);b.push(this.stride["+e+"])}");i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),i.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+u.map(function(n){return"shape["+n+"]"}).join(",")+","+u.map(function(n){return"stride["+n+"]"}).join(",")+",offset)}");var f=new Function("CTOR_LIST","ORDER",i.join(`
`));return f(T[a],ht)}function gt(a){if(ft(a))return"buffer";if(pt)switch(Object.prototype.toString.call(a)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(a)?"array":"generic"}var T={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function vt(a,o,r,c){if(a===void 0){var m=T.array[0];return m([])}else typeof a=="number"&&(a=[a]);o===void 0&&(o=[a.length]);var i=o.length;if(r===void 0){r=new Array(i);for(var u=i-1,l=1;u>=0;--u)r[u]=l,l*=o[u]}if(c===void 0){c=0;for(var u=0;u<i;++u)r[u]<0&&(c-=(o[u]-1)*r[u])}for(var y=gt(a),b=T[y];b.length<=i+1;)b.push(dt(y,b.length-1));var m=b[i+1];return m(a,o,r,c)}var mt=vt;function _t(a,o,r){const c=a,i=[];for(let u=0,l,y,b,m,j;u<o;u=u+r)l=u*4,y=c[l+0],b=c[l+1],m=c[l+2],j=c[l+3],(typeof j=="undefined"||j>=125)&&(y>250&&b>250&&m>250||i.push([y,b,m]));return i}function wt(a){let{colorCount:o,quality:r}=a;if(typeof o=="undefined"||!Number.isInteger(o))o=10;else{if(o===1)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");o=Math.max(o,2),o=Math.min(o,20)}return(typeof r=="undefined"||!Number.isInteger(r)||r<1)&&(r=10),{colorCount:o,quality:r}}function yt(a){return new Promise((o,r)=>{bt(a,function(c,i){c?r(c):o(i)})})}function bt(a,o){var r=new Image;r.crossOrigin="Anonymous",r.onload=function(){var c=document.createElement("canvas");c.width=r.width,c.height=r.height;var i=c.getContext("2d");i.drawImage(r,0,0);var u=i.getImageData(0,0,r.width,r.height);o(null,mt(new Uint8Array(u.data),[r.width,r.height,4],[4,4*r.width,1],0))},r.onerror=function(c){o(c)},r.src=a}function At(a,o){return new Promise((r,c)=>{Q(a,5,o).then(i=>{r(i[0])}).catch(i=>{c(i)})})}function Q(a,o=10,r=10){const c=wt({colorCount:o,quality:r});return new Promise((i,u)=>{yt(a).then(l=>{const y=l.shape[0]*l.shape[1],b=_t(l.data,y,c.quality),m=ot(b,c.colorCount),j=m?m.palette():null;i(j)}).catch(l=>{u(l)})})}const R=a=>(Y("data-v-f4895e7a"),a=a(),Z(),a),jt={class:"wrapper"},xt=X("\u9009\u62E9\u56FE\u7247"),Ct=R(()=>F("div",{class:"el-upload__tip"},"\u53EA\u80FD\u9009\u62E9jpg/png\u6587\u4EF6",-1)),Mt=["src"],Et=R(()=>F("h4",null,"getColor(url)",-1)),It=R(()=>F("h4",null,"getPalette(url, 6)",-1)),zt=R(()=>F("h4",null,"getPalette(url, 18)",-1)),Ot=K({__name:"index",setup(a){const o=W([]),r=(u,l)=>{let y=new FileReader;y.readAsDataURL(u.raw),y.onload=b=>{At(b.target.result).then(m=>{u.color=`rgb(${m.join(",")})`,c(u,l)}),Q(b.target.result,6).then(m=>{u.colors=m.map(j=>`rgb(${j.join(",")})`),c(u,l)}),Q(b.target.result,18).then(m=>{u.colors18=m.map(j=>`rgb(${j.join(",")})`),c(u,l)})}},c=(u,l)=>{u.color&&u.colors&&u.colors18&&(o.value=[...l])},i=(u,l)=>{o.value=l};return(u,l)=>{const y=rt,b=tt;return z(),O("div",jt,[G(b,{class:"upload-demo",ref:"upload",action:"","list-type":"picture-card","file-list":o.value,"auto-upload":!1,"on-change":r,"on-remove":i},{trigger:D(()=>[G(y,{type:"primary"},{default:D(()=>[xt]),_:1})]),tip:D(()=>[Ct]),_:1},8,["file-list"]),(z(!0),O(L,null,V(o.value,(m,j)=>(z(),O("ul",{class:"img-item",key:j},[F("img",{src:m.url},null,8,Mt),Et,F("div",{class:"rect",style:H(`background-color: ${m.color}`)},null,4),It,(z(!0),O(L,null,V(m.colors,(E,e)=>(z(),O("div",{class:"rect",key:Math.random(),style:H(`background-color: ${E}`)},null,4))),128)),zt,(z(!0),O(L,null,V(m.colors18,(E,e)=>(z(),O("div",{class:"rect",key:Math.random(),style:H(`background-color: ${E}`)},null,4))),128))]))),128))])}}});var Dt=et(Ot,[["__scopeId","data-v-f4895e7a"]]);export{Dt as default};
